

interface TaskInfo {
  title: string;
  desc: string;
  status: string;
  reward: number;
  time: string;
  type: string;
  button: string;
  icon: string;
  iconColor: string;
  topBarColor: string;
  btnType: string;
  avatar: Resource;
  user: string;
}


@Entry
@Component
struct TasksPagePhone {
  @State private task_count: number = 6;

  private tasks: TaskInfo[] = [
    {
      title: 'ä¸ŽAIåˆ†äº«ä¸€ä»¶å¼€å¿ƒäº‹',
      desc: 'å‘Šè¯‰AIä»Šå¤©è®©ä½ æ„Ÿåˆ°æ„‰å¿«çš„äº‹æƒ…ï¼Œåˆ†äº«å¿«ä¹å’Œèƒ½é‡',
      status: 'è¿›è¡Œä¸­',
      reward: 25,
      time: '12:45 å‰',
      type: 'primary',
      button: 'å®Œæˆä»»åŠ¡',
      icon: 'ðŸ’œ',
      iconColor: '#7c3aed',
      topBarColor: '#6366f1',
      btnType: 'primary',
      avatar: $r('app.media.background'),
      user: 'AIåŠ©æ‰‹'
    },
    {
      title: 'è®°å½•ä»Šå¤©çš„å¿ƒæƒ…',
      desc: 'æè¿°ä½ ä»Šå¤©çš„å¿ƒæƒ…ï¼Œå¸®åŠ©AIäº†è§£ä½ çš„æƒ…ç»ªå˜åŒ–',
      status: 'è¿›è¡Œä¸­',
      reward: 20,
      time: '18:30 å‰',
      type: 'warning',
      button: 'å®Œæˆä»»åŠ¡',
      icon: 'ðŸ’›',
      iconColor: '#fbbf24',
      topBarColor: '#f59e42',
      btnType: 'warning',
      avatar: $r('app.media.QQ1222'),
      user: 'AIåŠ©æ‰‹'
    },
    {
      title: 'å®Œæˆä¸€æ¬¡5åˆ†é’Ÿçš„å¯¹è¯',
      desc: 'ä¸ŽAIè¿›è¡Œä¸€æ¬¡æŒç»­5åˆ†é’Ÿçš„æœ‰æ„ä¹‰å¯¹è¯',
      status: 'è¿›è¡Œä¸­',
      reward: 30,
      time: '23:59 å‰',
      type: 'info',
      button: 'å¼€å§‹å¯¹è¯',
      icon: 'ðŸ’™',
      iconColor: '#3b82f6',
      topBarColor: '#3b82f6',
      btnType: 'info',
      avatar: $r('app.media.doro'),
      user: 'AIåŠ©æ‰‹'
    },
    {
      title: 'å­¦ä¹ ä¸€ä¸ªæ–°çŸ¥è¯†',
      desc: 'å‘AIè¯¢é—®ä¸€ä¸ªä½ æ„Ÿå…´è¶£çš„æ–°çŸ¥è¯†ï¼Œå¹¶è®°å½•ä¸‹æ¥',
      status: 'æœªå¼€å§‹',
      reward: 35,
      time: 'æ˜Žå¤© 12:00',
      type: 'default',
      button: 'æŽ¥å—ä»»åŠ¡',
      icon: 'ðŸ“š',
      iconColor: '#a78bfa',
      topBarColor: '#a78bfa',
      btnType: 'default',
      avatar: $r('app.media.background'),
      user: 'AIåŠ©æ‰‹'
    },
    {
      title: 'å®Œæˆä¸€ä¸ªæŒ‘æˆ˜',
      desc: 'é€‰æ‹©ä¸€ä¸ªéš¾åº¦è¾ƒé«˜çš„æŒ‘æˆ˜ï¼Œå¹¶æˆåŠŸå®Œæˆ',
      status: 'æœªå¼€å§‹',
      reward: 50,
      time: '23:59 å‰',
      type: 'danger',
      button: 'æŽ¥å—ä»»åŠ¡',
      icon: 'ðŸ”¥',
      iconColor: '#ef4444',
      topBarColor: '#ef4444',
      btnType: 'danger',
      avatar: $r('app.media.QQ1222'),
      user: 'AIåŠ©æ‰‹'
    },
    {
      title: 'é‚€è¯·æœ‹å‹åŠ å…¥',
      desc: 'é‚€è¯·ä¸€ä½æœ‹å‹ä¸€èµ·ä½¿ç”¨æœ¬åº”ç”¨ï¼Œå…±åŒæˆé•¿',
      status: 'è¿›è¡Œä¸­',
      reward: 40,
      time: '3å¤©åŽ',
      type: 'success',
      button: 'åˆ†äº«é‚€è¯·',
      icon: 'ðŸ¤',
      iconColor: '#22c55e',
      topBarColor: '#22c55e',
      btnType: 'success',
      avatar: $r('app.media.planet1'),
      user: 'AIåŠ©æ‰‹'
    },
    {
      title: 'ä»Šæ—¥æ­¥æ•°è¾¾æ ‡',
      desc: 'å®Œæˆ10000æ­¥ï¼Œä¿æŒå¥åº·ç”Ÿæ´»',
      status: 'æœªå¼€å§‹',
      reward: 15,
      time: 'ä»Šå¤©',
      type: 'success',
      button: 'å¼€å§‹è®¡æ­¥',
      icon: 'ðŸš¶â€â™‚ï¸',
      iconColor: '#22c55e',
      topBarColor: '#22c55e',
      btnType: 'success',
      avatar: $r('app.media.background'),
      user: 'AIåŠ©æ‰‹'
    },
    {
      title: 'å†¥æƒ³10åˆ†é’Ÿ',
      desc: 'é™ä¸‹å¿ƒæ¥ï¼Œè¿›è¡Œ10åˆ†é’Ÿå†¥æƒ³ï¼Œæ”¾æ¾èº«å¿ƒ',
      status: 'æœªå¼€å§‹',
      reward: 18,
      time: 'ä»Šå¤©',
      type: 'primary',
      button: 'å¼€å§‹å†¥æƒ³',
      icon: 'ðŸ§˜â€â™‚ï¸',
      iconColor: '#6366f1',
      topBarColor: '#6366f1',
      btnType: 'primary',
      avatar: $r('app.media.QQ1222'),
      user: 'AIåŠ©æ‰‹'
    },
    {
      title: 'é˜…è¯»30åˆ†é’Ÿ',
      desc: 'é˜…è¯»ä¸€æœ¬å–œæ¬¢çš„ä¹¦ç±ï¼Œæå‡è‡ªæˆ‘',
      status: 'æœªå¼€å§‹',
      reward: 22,
      time: 'ä»Šå¤©',
      type: 'warning',
      button: 'å¼€å§‹é˜…è¯»',
      icon: 'ðŸ“–',
      iconColor: '#fbbf24',
      topBarColor: '#fbbf24',
      btnType: 'warning',
      avatar: $r('app.media.planet1'),
      user: 'AIåŠ©æ‰‹'
    }
  ];

  build() {
    Column() {
      Scroll() {
        Column({ space: 16 }) {
          // é¡¶éƒ¨æ ‡é¢˜å’ŒæŒ‰é’®
          Text('æ—¥å¸¸ä»»åŠ¡')
            .fontSize(22).fontWeight(FontWeight.Bold)
            .fontColor('#222')
            .margin({ top: 18, left: 16, right: 16, bottom: 2 })
          Text('å®Œæˆä»»åŠ¡ï¼Œè®©ä½ çš„è‡ªæˆ‘æˆé•¿')
            .fontSize(13).fontColor('#888')
            .margin({ left: 16, right: 16, bottom: 8 })
          Row({ space: 10 }) {
            Button('åˆ·æ–°ä»»åŠ¡')
              .fontSize(13)
              .fontColor('#fff')
              .backgroundColor('#22c55e')
              .borderRadius(8)
              .padding({ left: 12, right: 12, top: 5, bottom: 5 })
            Button('ä»»åŠ¡æ—¥åŽ†')
              .fontSize(13)
              .fontColor('#222')
              .backgroundColor('#fff')
              .border({ color: '#e0e0e0', width: 1 })
              .borderRadius(8)
              .padding({ left: 12, right: 12, top: 5, bottom: 5 })
          }
          .margin({ left: 16, right: 16, bottom: 8 })

          // ä»»åŠ¡å¡ç‰‡åŒº - å•åˆ—ç«–å‘æ»šåŠ¨
          Column({ space: 12 }) {
            ForEach(this.tasks.slice(0, this.task_count), (task: TaskInfo) => {
              TaskCardPhone(task)
            })
          }
          .margin({ left: 12, right: 12 })

          // åº•éƒ¨æŒ‰é’®
          Button(this.task_count < this.tasks.length ? 'æŸ¥çœ‹æ›´å¤šä»»åŠ¡' : 'å·²æ˜¾ç¤ºå…¨éƒ¨ä»»åŠ¡')
            .margin({ top: 16, bottom: 16 })
            .width('80%')
            .backgroundColor('#222')
            .fontColor('#fff')
            .fontSize(15)
            .borderRadius(8)
            .alignSelf(ItemAlign.Center)
            .fontWeight(FontWeight.Bold)
            .onClick(() => {
              if (this.task_count < this.tasks.length) {
                this.task_count = this.tasks.length;
              }
            })
        }
        .backgroundColor('#f7f8fa')
        .width('100%')
        .padding(8)
      }
    }
    .width('100%')
    .height('100%')
  }
}

@Builder
function TaskCardPhone(task: TaskInfo) {
  Column() {
    // é¡¶éƒ¨è‰²æ¡
    Column()
      .width('100%')
      .height(3)
      .backgroundColor(task.topBarColor)
      .borderRadius({ topLeft: 8, topRight: 8 })
    // å†…å®¹åŒº
    Column({ space: 6 }) {
      Row({ space: 6 }) {
        Text(task.icon)
          .fontSize(18)
        Text(task.title)
          .fontSize(14)
          .fontWeight(FontWeight.Bold)
          .fontColor('#222')
          .maxLines(1)
        Text(task.status)
          .fontSize(11)
          .fontColor(task.status === 'è¿›è¡Œä¸­' ? '#22c55e' : '#888')
          .backgroundColor(task.status === 'è¿›è¡Œä¸­' ? '#e0ffe5' : '#eee')
          .padding({ left: 6, right: 6, top: 2, bottom: 2 })
          .borderRadius(8)
          .margin({ left: 4 })
      }
      Text(task.desc)
        .fontSize(12)
        .fontColor('#666')
        .maxLines(2)
        .margin({ bottom: 2 })
      Row({ space: 6 }) {
        Text('ðŸ‘¤').fontSize(14)
        Text(task.user).fontSize(11).fontColor('#888')
        Text('â˜… ' + task.reward).fontSize(11).fontColor('#fbbf24')
        Text(task.time).fontSize(11).fontColor('#bbb')
      }
      Row() {
        TaskBtnPhone(task.button, getBtnColor(task.btnType), task.btnType === 'default')
      }
    }
    .padding({ left: 10, right: 10, top: 6, bottom: 10 })
  }
  .backgroundColor('#fff')
  .borderRadius(12)
  .shadow({ radius: 5, color: '#e5e7eb', offsetX: 0, offsetY: 1 })
  .width('100%')
  .padding(2)
}

@Builder
function TaskBtnPhone(label: string, color: string, isOutline: boolean) {
  Button(label)
    .width('100%')
    .fontSize(13)
    .fontWeight(FontWeight.Bold)
    .backgroundColor(isOutline ? '#fff' : color)
    .fontColor(isOutline ? color : '#fff')
    .border({ color: color, width: isOutline ? 1 : 0 })
    .borderRadius(8)
    .padding({ top: 5, bottom: 5 })
}

function getBtnColor(type: string): string {
  switch (type) {
    case 'primary': return '#6366f1'
    case 'warning': return '#f59e42'
    case 'info': return '#3b82f6'
    case 'danger': return '#ef4444'
    case 'success': return '#22c55e'
    default: return '#888'
  }
}