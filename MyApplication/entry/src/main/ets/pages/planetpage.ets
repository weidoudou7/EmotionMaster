import { BottomNavBar } from './BottomNavBar'

@Entry
@Component
struct PlanetPagePhone {
  private planetName: string = 'å¸Œæœ›ä¹‹æ˜Ÿ'
  private planetDesc: string = 'ä¸€ä¸ªå……æ»¡æ´»åŠ›å’Œå¸Œæœ›çš„æ˜Ÿçƒ'
  private planetLevel: number = 5
  private planetImage: string = '/resources/base/media/QQ1222.jpg'
  private ecoPercent: number = 78
  private techPercent: number = 65
  private culturePercent: number = 82
  private talkHours: number = 12.5
  private talkTarget: number = 20
  private taskCount: number = 28
  private taskTarget: number = 50
  private explorePercent: number = 42

  build() {
    Column() {
      Scroll() {
        Column({ space: 18 }) {
          // é¡¶éƒ¨æ ‡é¢˜
          Text('æˆ‘çš„æ˜Ÿçƒ')
            .fontSize(24).fontWeight(FontWeight.Bold)
            .fontColor('#222')
            .margin({ top: 18, left: 20, right: 20, bottom: 2 })
          Text('ä¸AIäº’åŠ¨ï¼Œè®©å®ƒèŒå£®æˆé•¿')
            .fontSize(13).fontColor('#888')
            .margin({ left: 20, right: 20, bottom: 8 })
          // æ˜Ÿçƒå›¾ç‰‡+ç­‰çº§
          Stack() {
            Image(this.planetImage)
              .width(140).height(140)
              .borderRadius(70)
              .shadow({ radius: 16, color: '#e0e6ff', offsetX: 0, offsetY: 6 })
            Text(`ç­‰çº§${this.planetLevel}`)
              .fontSize(13).fontColor('#fff')
              .backgroundColor('#ffb400')
              .borderRadius(10)
              .padding({ left: 8, right: 8, top: 2, bottom: 2 })
              .position({ x: 100, y: 12 })
              .zIndex(1)
          }
          .align(Alignment.Center)
          // æ˜Ÿçƒåç§°å’Œç®€ä»‹
          Text(this.planetName)
            .fontSize(18).fontWeight(FontWeight.Bold)
            .alignSelf(ItemAlign.Center)
          Text(this.planetDesc)
            .fontSize(13).fontColor('#888')
            .alignSelf(ItemAlign.Center)
          // ä¸‰é¡¹å±æ€§
          Row({ space: 10 }) {
            AttrCard('ç”Ÿæ€ç³»ç»Ÿ', `${this.ecoPercent}%`, '#4caf50', 'ğŸ”—')
            AttrCard('ç§‘æŠ€æ°´å¹³', `${this.techPercent}%`, '#3f51b5', 'ğŸš€')
            AttrCard('æ–‡åŒ–å‘å±•', `${this.culturePercent}%`, '#ab47bc', 'ğŸ“–')
          }
          .alignSelf(ItemAlign.Center)
          .margin({ top: 8, left: 8, right: 8 })
          // æˆé•¿è¿›åº¦
          Text('æˆé•¿è¿›åº¦').fontSize(16).fontWeight(FontWeight.Bold).margin({ left: 20, top: 16, bottom: 4 })
          Column({ space: 12 }) {
            ProgressItem('å½“å‰ç­‰çº§', `${this.planetLevel}`, 0.75, 'ç­‰çº§ 5', '75%åˆ°ç­‰çº§6', '#5a4fff')
            ProgressItem('æ€»å¯¹è¯æ—¶é•¿', `${this.talkHours} å°æ—¶`, this.talkHours / this.talkTarget, `ç›®æ ‡: ${this.talkTarget} å°æ—¶`, '63%', '#00b386')
            ProgressItem('å®Œæˆä»»åŠ¡æ•°', `${this.taskCount} ä¸ª`, this.taskCount / this.taskTarget, `ç›®æ ‡: ${this.taskTarget} ä¸ª`, '56%', '#ffb400')
            ProgressItem('æ¢ç´¢åº¦', `${this.explorePercent}%`, this.explorePercent / 100, 'ç›®æ ‡: 100%', '42%', '#5a4fff')
          }
          .margin({ left: 20, right: 20 })
          // æˆé•¿å¥–åŠ±
          Text('æˆé•¿å¥–åŠ±').fontSize(15).fontWeight(FontWeight.Bold).margin({ left: 20, top: 12, bottom: 4 })
          Row({ space: 10 }) {
            RewardTag('æ˜Ÿçƒçš®è‚¤', true)
            RewardTag('ç‰¹æ®Šè£…é¥°', true)
            RewardTag('ç«ç®­é£èˆ¹', false)
          }
          .margin({ left: 20, right: 20, bottom: 24 })
        }
        .backgroundColor('#fafbff')
      }
      BottomNavBar({ navIndex: 'planet' })
    }
    .width('100%')
    .height('100%')
  }
}

@Builder
function AttrCard(title: string, value: string, color: string, icon: string) {
  Column({ space: 2 }) {
    Row() {
      Text(icon).fontSize(16)
      Text(title).fontSize(12).fontColor('#888').margin({ left: 2 })
    }
    Text(value).fontSize(15).fontWeight(FontWeight.Bold).fontColor(color)
  }
  .backgroundColor('#fff')
  .borderRadius(10)
  .padding({ left: 10, right: 10, top: 6, bottom: 6 })
  .shadow({ radius: 3, color: '#eee', offsetX: 0, offsetY: 1 })
}

@Builder
function ProgressItem(title: string, value: string, percent: number, subTitle: string, subValue: string, color: string) {
  Column({ space: 2 }) {
    Row({ space: 8 }) {
      Text(title).fontSize(13)
      Text(value).fontSize(13).fontWeight(FontWeight.Bold).fontColor(color)
    }
    Progress({ value: percent * 100, total: 100 })
      .color(color)
      .height(7)
      .backgroundColor('#e0e0e0')
      .borderRadius(3)
    Row({ space: 8 }) {
      Text(subTitle).fontSize(11).fontColor('#888')
      Text(subValue).fontSize(11).fontColor('#888')
    }
  }
}

@Builder
function RewardTag(label: string, unlocked: boolean) {
  Row() {
    Text(label)
      .fontSize(12)
      .fontColor(unlocked ? '#00b386' : '#888')
      .backgroundColor(unlocked ? '#e0ffe6' : '#f0f0f0')
      .borderRadius(7)
      .padding({ left: 8, right: 8, top: 3, bottom: 3 })
  }
}
