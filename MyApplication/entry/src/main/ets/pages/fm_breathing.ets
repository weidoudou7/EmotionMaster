import router from '@ohos.router';

// å‘¼å¸æ¨¡å¼å®šä¹‰
interface BreathingPattern {
  id: string;
  name: string;
  description: string;
  inhaleTime: number;
  holdTime: number;
  exhaleTime: number;
  holdAfterExhale: number;
  emoji: string;
  color: string;
  bgColor: string;
}

const BREATHING_PATTERNS: BreathingPattern[] = [
  {
    id: '478',
    name: '4-7-8å‘¼å¸æ³•',
    description: 'ç»å…¸æ”¾æ¾å‘¼å¸ï¼Œç¼“è§£ç„¦è™‘',
    inhaleTime: 4,
    holdTime: 7,
    exhaleTime: 8,
    holdAfterExhale: 0,
    emoji: 'ðŸŒ¬ï¸',
    color: '#4CAF50',
    bgColor: '#E8F5E8'
  },
  {
    id: 'box',
    name: 'æ–¹æ¡†å‘¼å¸',
    description: 'å¹³è¡¡å‘¼å¸èŠ‚å¥ï¼Œæå‡ä¸“æ³¨',
    inhaleTime: 4,
    holdTime: 4,
    exhaleTime: 4,
    holdAfterExhale: 4,
    emoji: 'â¬œ',
    color: '#2196F3',
    bgColor: '#E3F2FD'
  },
  {
    id: 'belly',
    name: 'è…¹å¼å‘¼å¸',
    description: 'æ·±åº¦è…¹å¼å‘¼å¸ï¼Œç¼“è§£åŽ‹åŠ›',
    inhaleTime: 5,
    holdTime: 2,
    exhaleTime: 6,
    holdAfterExhale: 1,
    emoji: 'ðŸ«',
    color: '#FF9800',
    bgColor: '#FFF3E0'
  },
  {
    id: 'coherence',
    name: 'å’Œè°å‘¼å¸',
    description: '6ç§’å‘¼å¸èŠ‚å¥ï¼Œå¹³è¡¡èº«å¿ƒ',
    inhaleTime: 6,
    holdTime: 0,
    exhaleTime: 6,
    holdAfterExhale: 0,
    emoji: 'ðŸ’«',
    color: '#9C27B0',
    bgColor: '#F3E5F5'
  }
];

@Entry
@Component
struct FMBreathingPage {
  @State currentPattern: BreathingPattern = BREATHING_PATTERNS[0];
  @State isPlaying: boolean = false;
  @State currentPhase: 'inhale' | 'hold' | 'exhale' | 'holdAfterExhale' = 'inhale';
  @State phaseProgress: number = 0;
  @State totalProgress: number = 0;
  @State elapsedSeconds: number = 0;
  @State selectedDuration: number = 300; // 5åˆ†é’Ÿ
  @State selectedPatternIndex: number = 0;
  @State showPatternSelector: boolean = false;
  @State showSettings: boolean = false;
  @State breathCount: number = 0;
  @State circleScale: number = 1.0;
  @State circleOpacity: number = 0.8;
  @State phaseStartTime: number = 0;
  @State sessionStartTime: number = 0;
  @State pausedTime: number = 0;
  @State isPaused: boolean = false;
  @State savedCircleScale: number = 1.0;
  @State savedCircleOpacity: number = 0.8;
  @State textOpacity: number = 1.0;
  @State textTranslateY: number = 0;
  @State isTransitioning: boolean = false;
  
  private timer: number = -1;
  private phaseTimer: number = -1;
  private durationOptions: number[] = [60, 180, 300, 600, 900]; // 1,3,5,10,15åˆ†é’Ÿ
  private durationLabels: string[] = ['1åˆ†é’Ÿ', '3åˆ†é’Ÿ', '5åˆ†é’Ÿ', '10åˆ†é’Ÿ', '15åˆ†é’Ÿ'];

  aboutToDisappear() {
    this.stopBreathing();
  }

  private startBreathing() {
    if (this.isPaused) {
      // æ¢å¤æš‚åœçš„ä¼šè¯
      this.resumeBreathing();
    } else {
      // å¼€å§‹æ–°çš„ä¼šè¯
      this.isPlaying = true;
      this.breathCount = 0;
      this.elapsedSeconds = 0;
      this.totalProgress = 0;
      this.sessionStartTime = Date.now();
      // é‡ç½®æ–‡å­—åŠ¨ç”»çŠ¶æ€
      this.textOpacity = 1.0;
      this.textTranslateY = 0;
      this.isTransitioning = false;
      this.startBreathingCycle();
    }
  }

  private pauseBreathing() {
    // åœæ­¢è®¡æ—¶å™¨
    if (this.phaseTimer !== -1) {
      clearInterval(this.phaseTimer);
      this.phaseTimer = -1;
    }
    
    // ä¿å­˜å½“å‰åŠ¨ç”»çŠ¶æ€
    this.savedCircleScale = this.circleScale;
    this.savedCircleOpacity = this.circleOpacity;
    
    this.isPlaying = false;
    this.isPaused = true;
    this.pausedTime = Date.now();
  }

  private resumeBreathing() {
    if (!this.isPaused) return;
    
    const pauseDuration = Date.now() - this.pausedTime;
    // è°ƒæ•´å¼€å§‹æ—¶é—´ä»¥è¡¥å¿æš‚åœçš„æ—¶é—´
    this.sessionStartTime += pauseDuration;
    this.phaseStartTime += pauseDuration;
    
    // æ¢å¤åŠ¨ç”»çŠ¶æ€
    this.circleScale = this.savedCircleScale;
    this.circleOpacity = this.savedCircleOpacity;
    
    this.isPlaying = true;
    this.isPaused = false;
    this.animatePhase();
  }

  private stopBreathing() {
    if (this.timer !== -1) {
      clearInterval(this.timer);
      this.timer = -1;
    }
    if (this.phaseTimer !== -1) {
      clearInterval(this.phaseTimer);
      this.phaseTimer = -1;
    }
    this.isPlaying = false;
    this.isPaused = false;
    this.currentPhase = 'inhale';
    this.phaseProgress = 0;
    this.circleScale = 1.0;
    this.circleOpacity = 0.8;
    this.savedCircleScale = 1.0;
    this.savedCircleOpacity = 0.8;
    this.elapsedSeconds = 0;
    this.totalProgress = 0;
    this.breathCount = 0;
    // é‡ç½®æ–‡å­—åŠ¨ç”»çŠ¶æ€
    this.textOpacity = 1.0;
    this.textTranslateY = 0;
    this.isTransitioning = false;
  }

  private startBreathingCycle() {
    this.currentPhase = 'inhale';
    this.phaseProgress = 0;
    this.phaseStartTime = Date.now();
    this.animatePhase();
  }

  private animatePhase() {
    const pattern = this.currentPattern;
    let phaseDuration = 0;
    
    switch (this.currentPhase) {
      case 'inhale':
        phaseDuration = pattern.inhaleTime;
        break;
      case 'hold':
        phaseDuration = pattern.holdTime;
        break;
      case 'exhale':
        phaseDuration = pattern.exhaleTime;
        break;
      case 'holdAfterExhale':
        phaseDuration = pattern.holdAfterExhale;
        break;
    }

    if (phaseDuration === 0) {
      this.nextPhase();
      return;
    }

    // åŠ¨ç”»æ•ˆæžœ - é˜²æ­¢åŠ¨ç”»å›žè°ƒå¹²æ‰°é˜¶æ®µåˆ‡æ¢
    if (this.isPlaying) {
      if (this.currentPhase === 'inhale') {
        // å¸æ°”åŠ¨ç”»ï¼šä»Žå°åˆ°å¤§çš„åœ†åœˆ
        animateTo({ duration: phaseDuration * 1000, curve: Curve.EaseInOut }, () => {
          // åŠ¨ç”»å®ŒæˆåŽçš„çŠ¶æ€ - ä½†ä¸è§¦å‘é˜¶æ®µåˆ‡æ¢
          if (this.isPlaying && this.currentPhase === 'inhale') {
            this.circleScale = 1.8;
            this.circleOpacity = 1.0;
          }
        });
      } else if (this.currentPhase === 'exhale') {
        // å‘¼æ°”åŠ¨ç”»ï¼šä»Žå¤§åˆ°å°çš„åœ†åœˆ
        animateTo({ duration: phaseDuration * 1000, curve: Curve.EaseInOut }, () => {
          // åŠ¨ç”»å®ŒæˆåŽçš„çŠ¶æ€ - ä½†ä¸è§¦å‘é˜¶æ®µåˆ‡æ¢
          if (this.isPlaying && this.currentPhase === 'exhale') {
            this.circleScale = 1.0;
            this.circleOpacity = 0.8;
          }
        });
      } else if (this.currentPhase === 'hold') {
        // å±æ¯çŠ¶æ€ï¼šä¿æŒå¸æ°”å®Œæˆçš„çŠ¶æ€
        this.circleScale = 1.8;
        this.circleOpacity = 1.0;
      } else if (this.currentPhase === 'holdAfterExhale') {
        // å‘¼æ°”åŽå±æ¯çŠ¶æ€ï¼šä¿æŒå‘¼æ°”å®Œæˆçš„çŠ¶æ€
        this.circleScale = 1.0;
        this.circleOpacity = 0.8;
      }
    }

    // ä½¿ç”¨æ›´ç²¾ç¡®çš„è®¡æ—¶å™¨ï¼Œç‹¬ç«‹äºŽåŠ¨ç”»
    this.phaseTimer = setInterval(() => {
      if (!this.isPlaying) {
        return; // å¦‚æžœæš‚åœäº†ï¼Œä¸æ›´æ–°æ—¶é—´
      }
      
      const currentTime = Date.now();
      const phaseElapsed = Math.floor((currentTime - this.phaseStartTime) / 1000);
      const sessionElapsed = Math.floor((currentTime - this.sessionStartTime) / 1000);
      
      // ä½¿ç”¨å®žé™…ç»è¿‡çš„æ—¶é—´ä½œä¸ºè¿›åº¦ï¼Œä¸è¿›è¡Œé™åˆ¶
      this.phaseProgress = phaseElapsed;
      this.elapsedSeconds = sessionElapsed;
      
      // ç¡®ä¿é˜¶æ®µå®Œå…¨ç»“æŸåŽæ‰åˆ‡æ¢ï¼Œä½¿ç”¨ä¸¥æ ¼çš„æ—¶é—´æ¯”è¾ƒ
      if (phaseElapsed >= phaseDuration) {
        clearInterval(this.phaseTimer);
        this.phaseTimer = -1;
        if (this.isPlaying) {
          // ç¡®ä¿å½“å‰é˜¶æ®µç¡®å®žåº”è¯¥ç»“æŸ
          const actualPhaseDuration = this.getPhaseTime();
          if (phaseElapsed >= actualPhaseDuration) {
            this.nextPhase();
          }
        }
      }
    }, 100); // æ›´é¢‘ç¹çš„æ›´æ–°ä»¥èŽ·å¾—æ›´ç²¾ç¡®çš„è®¡æ—¶
  }

  private nextPhase() {
    if (!this.isPlaying) {
      return; // å¦‚æžœæš‚åœäº†ï¼Œä¸è¿›å…¥ä¸‹ä¸€é˜¶æ®µ
    }
    
    const pattern = this.currentPattern;
    
    switch (this.currentPhase) {
      case 'inhale':
        if (pattern.holdTime > 0) {
          this.currentPhase = 'hold';
        } else if (pattern.exhaleTime > 0) {
          this.currentPhase = 'exhale';
        } else {
          this.completeBreath();
        }
        break;
      case 'hold':
        if (pattern.exhaleTime > 0) {
          this.currentPhase = 'exhale';
        } else {
          this.completeBreath();
        }
        break;
      case 'exhale':
        if (pattern.holdAfterExhale > 0) {
          this.currentPhase = 'holdAfterExhale';
        } else {
          this.completeBreath();
        }
        break;
      case 'holdAfterExhale':
        this.completeBreath();
        break;
    }
    
    // è§¦å‘æ–‡å­—åˆ‡æ¢åŠ¨ç”»
    this.animateTextTransition();
    
    // é‡ç½®é˜¶æ®µè¿›åº¦å’Œæ—¶é—´
    this.phaseProgress = 0;
    this.phaseStartTime = Date.now();
    
    // å»¶è¿Ÿä¸€å¸§å†å¼€å§‹ä¸‹ä¸€ä¸ªé˜¶æ®µçš„åŠ¨ç”»ï¼Œç¡®ä¿çŠ¶æ€å®Œå…¨æ›´æ–°
    setTimeout(() => {
      if (this.isPlaying) {
        this.animatePhase();
      }
    }, 10);
  }

  private completeBreath() {
    if (!this.isPlaying) {
      return; // å¦‚æžœæš‚åœäº†ï¼Œä¸å®Œæˆå‘¼å¸å‘¨æœŸ
    }
    
    this.breathCount++;
    this.totalProgress = (this.elapsedSeconds / this.selectedDuration) * 100;
    
    if (this.elapsedSeconds >= this.selectedDuration) {
      this.stopBreathing();
      return;
    }
    
    // å¼€å§‹æ–°çš„å‘¼å¸å‘¨æœŸ
    this.currentPhase = 'inhale';
    this.phaseProgress = 0;
    this.phaseStartTime = Date.now();
    
    // å»¶è¿Ÿä¸€å¸§å†å¼€å§‹æ–°çš„å‘¼å¸å‘¨æœŸï¼Œç¡®ä¿çŠ¶æ€å®Œå…¨é‡ç½®
    setTimeout(() => {
      if (this.isPlaying) {
        this.animatePhase();
      }
    }, 10);
  }

  private getPhaseText(): string {
    switch (this.currentPhase) {
      case 'inhale':
        return 'å¸æ°”';
      case 'hold':
        return 'å±æ¯';
      case 'exhale':
        return 'å‘¼æ°”';
      case 'holdAfterExhale':
        return 'å±æ¯';
      default:
        return '';
    }
  }

  private getPhaseTime(): number {
    const pattern = this.currentPattern;
    switch (this.currentPhase) {
      case 'inhale':
        return pattern.inhaleTime;
      case 'hold':
        return pattern.holdTime;
      case 'exhale':
        return pattern.exhaleTime;
      case 'holdAfterExhale':
        return pattern.holdAfterExhale;
      default:
        return 0;
    }
  }

  private getRemainingTime(): number {
    const phaseTime = this.getPhaseTime();
    const remaining = phaseTime - this.phaseProgress;
    return Math.max(0, remaining);
  }

  private animateTextTransition() {
    this.isTransitioning = true;
    
    // å½“å‰æ–‡å­—å‘ä¸‹æ·¡å‡º
    animateTo({ duration: 300, curve: Curve.EaseInOut }, () => {
      this.textOpacity = 0;
      this.textTranslateY = 20;
    });
    
    // å»¶è¿ŸåŽæ–°æ–‡å­—å‘ä¸Šæ·¡å…¥
    setTimeout(() => {
      if (this.isPlaying) {
        animateTo({ duration: 300, curve: Curve.EaseInOut }, () => {
          this.textOpacity = 1;
          this.textTranslateY = 0;
        });
        
        // åŠ¨ç”»å®ŒæˆåŽé‡ç½®çŠ¶æ€
        setTimeout(() => {
          this.isTransitioning = false;
        }, 300);
      }
    }, 300);
  }

  build() {
    Column() {
      // é¡¶éƒ¨å¯¼èˆª
      Row() {
        Button('â€¹')
          .fontSize(22)
          .fontColor('#1976D2')
          .backgroundColor('#fff')
          .borderRadius(18)
          .width(36)
          .height(36)
          .shadow({ radius: 4, color: 'rgba(0,0,0,0.08)', offsetX: 0, offsetY: 2 })
          .onClick(() => router.back())
        Text('å‘¼å¸è®­ç»ƒ')
          .fontSize(20)
          .fontWeight(FontWeight.Bold)
          .fontColor('#1976D2')
          .layoutWeight(1)
          .textAlign(TextAlign.Center)
        Button('âš™ï¸')
          .fontSize(18)
          .fontColor('#1976D2')
          .backgroundColor('#fff')
          .borderRadius(18)
          .width(36)
          .height(36)
          .shadow({ radius: 4, color: 'rgba(0,0,0,0.08)', offsetX: 0, offsetY: 2 })
          .onClick(() => this.showSettings = true)
      }
      .width('100%')
      .padding({ top: 16, left: 12, right: 12, bottom: 16 })

      // å¯æ»šåŠ¨å†…å®¹åŒºåŸŸ
      Scroll() {
        Column() {
          // å‘¼å¸æ¨¡å¼é€‰æ‹©å™¨
          if (!this.isPlaying) {
            Column() {
              Text('é€‰æ‹©å‘¼å¸æ¨¡å¼')
                .fontSize(16)
                .fontWeight(FontWeight.Bold)
                .fontColor('#333')
                .margin({ bottom: 12 })
              
              ForEach(BREATHING_PATTERNS, (pattern: BreathingPattern, idx: number) => {
                Row() {
                  Text(pattern.emoji)
                    .fontSize(24)
                    .margin({ right: 12 })
                  Column() {
                    Text(pattern.name)
                      .fontSize(16)
                      .fontWeight(FontWeight.Bold)
                      .fontColor('#333')
                    Text(pattern.description)
                      .fontSize(13)
                      .fontColor('#666')
                      .margin({ top: 2 })
                    Text(`${pattern.inhaleTime}-${pattern.holdTime}-${pattern.exhaleTime}${pattern.holdAfterExhale > 0 ? '-' + pattern.holdAfterExhale : ''}`)
                      .fontSize(12)
                      .fontColor(pattern.color)
                      .margin({ top: 4 })
                  }
                  .layoutWeight(1)
                }
                .width('100%')
                .padding(16)
                .backgroundColor(this.selectedPatternIndex === idx ? pattern.bgColor : '#f8f9fa')
                .borderRadius(12)
                .margin({ bottom: 8 })
                .onClick(() => {
                  this.selectedPatternIndex = idx;
                  this.currentPattern = pattern;
                })
              }, (pattern: BreathingPattern) => pattern.id)
            }
            .width('100%')
            .padding({ left: 16, right: 16 })
            .margin({ bottom: 20 })

            // æ—¶é•¿é€‰æ‹©
            Column() {
              Text('è®­ç»ƒæ—¶é•¿')
                .fontSize(16)
                .fontWeight(FontWeight.Bold)
                .fontColor('#333')
                .margin({ bottom: 12 })
              
              // ç¬¬ä¸€è¡Œï¼š1ã€3ã€5åˆ†é’Ÿ
              Row() {
                ForEach([0, 1, 2], (idx: number) => {
                  Button(this.durationLabels[idx])
                    .fontColor(this.selectedDuration === this.durationOptions[idx] ? '#fff' : '#1976D2')
                    .backgroundColor(this.selectedDuration === this.durationOptions[idx] ? '#1976D2' : '#E3F2FD')
                    .borderRadius(16)
                    .fontSize(14)
                    .padding({ left: 16, right: 16, top: 8, bottom: 8 })
                    .margin({ right: 8 })
                    .onClick(() => {
                      this.selectedDuration = this.durationOptions[idx];
                    })
                })
              }
              .width('100%')
              .justifyContent(FlexAlign.Center)
              .margin({ bottom: 8 })
              
              // ç¬¬äºŒè¡Œï¼š10ã€15åˆ†é’Ÿ
              Row() {
                ForEach([3, 4], (idx: number) => {
                  Button(this.durationLabels[idx])
                    .fontColor(this.selectedDuration === this.durationOptions[idx] ? '#fff' : '#1976D2')
                    .backgroundColor(this.selectedDuration === this.durationOptions[idx] ? '#1976D2' : '#E3F2FD')
                    .borderRadius(16)
                    .fontSize(14)
                    .padding({ left: 16, right: 16, top: 8, bottom: 8 })
                    .margin({ right: 8 })
                    .onClick(() => {
                      this.selectedDuration = this.durationOptions[idx];
                    })
                })
              }
              .width('100%')
              .justifyContent(FlexAlign.Center)
            }
            .width('100%')
            .padding({ left: 16, right: 16 })
            .margin({ bottom: 24 })
          }

          // å‘¼å¸åŠ¨ç”»åŒºåŸŸ
          Column() {
            Stack() {
              // èƒŒæ™¯åœ†åœˆ
              Circle()
                .width(280)
                .height(280)
                .fill(this.currentPattern.bgColor)
                .opacity(0.3)
              
              // åŠ¨æ€å‘¼å¸åœ†åœˆ
              Circle()
                .width(200)
                .height(200)
                .fill(this.currentPattern.color)
                .opacity(this.circleOpacity)
                .scale({ x: this.circleScale, y: this.circleScale })
              
              // ä¸­å¿ƒæ–‡å­—
              Column() {
                if (this.isPlaying) {
                  Text(this.getPhaseText())
                    .fontSize(32)
                    .fontWeight(FontWeight.Bold)
                    .fontColor('#fff')
                    .margin({ bottom: 8 })
                    .opacity(this.textOpacity)
                    .translate({ y: this.textTranslateY })
                  Text(`${Math.max(0, this.getRemainingTime())}s`)
                    .fontSize(18)
                    .fontColor('#fff')
                    .opacity(0.9)
                } else if (this.isPaused) {
                  Text('â¸ï¸')
                    .fontSize(48)
                    .margin({ bottom: 8 })
                  Text('å·²æš‚åœ')
                    .fontSize(20)
                    .fontWeight(FontWeight.Bold)
                    .fontColor('#333')
                } else {
                  Text(this.currentPattern.emoji)
                    .fontSize(48)
                    .margin({ bottom: 8 })
                  Text('å‡†å¤‡å¼€å§‹')
                    .fontSize(20)
                    .fontWeight(FontWeight.Bold)
                    .fontColor('#333')
                }
              }
            }
            .width('100%')
            .height(320)
            .margin({ bottom: 24 })

            // æŽ§åˆ¶æŒ‰é’®
            Row() {
              Button(this.isPlaying ? 'æš‚åœ' : (this.isPaused ? 'ç»§ç»­' : 'å¼€å§‹'))
                .fontColor('#fff')
                .backgroundColor(this.isPlaying ? '#FF5722' : '#4CAF50')
                .borderRadius(24)
                .fontSize(18)
                .fontWeight(FontWeight.Bold)
                .padding({ left: 40, right: 40, top: 12, bottom: 12 })
                .margin({ right: 12 })
                .onClick(() => {
                  if (this.isPlaying) {
                    this.pauseBreathing();
                  } else {
                    this.startBreathing();
                  }
                })
              
              if (this.isPlaying || this.isPaused) {
                Button('åœæ­¢')
                  .fontColor('#fff')
                  .backgroundColor('#666')
                  .borderRadius(24)
                  .fontSize(18)
                  .fontWeight(FontWeight.Bold)
                  .padding({ left: 40, right: 40, top: 12, bottom: 12 })
                  .onClick(() => {
                    this.stopBreathing();
                  })
              }
            }
            .width('100%')
            .justifyContent(FlexAlign.Center)
            .margin({ bottom: 20 })

            // è¿›åº¦ä¿¡æ¯
            if (this.isPlaying || this.isPaused) {
              Column() {
                Row() {
                  Text(`å‘¼å¸æ¬¡æ•°: ${this.breathCount}`)
                    .fontSize(14)
                    .fontColor('#666')
                  Text(`å‰©ä½™æ—¶é—´: ${Math.max(0, Math.floor((this.selectedDuration - this.elapsedSeconds) / 60))}:${Math.max(0, (this.selectedDuration - this.elapsedSeconds) % 60).toString().padStart(2, '0')}`)
                    .fontSize(14)
                    .fontColor('#666')
                }
                .width('100%')
                .justifyContent(FlexAlign.SpaceBetween)
                .margin({ bottom: 8 })
                
                Progress({ value: this.totalProgress })
                  .color(this.currentPattern.color)
                  .backgroundColor('#E0E0E0')
                  .width('100%')
                  .height(6)
                  .borderRadius(3)
              }
              .width('100%')
              .padding({ left: 16, right: 16 })
              .margin({ bottom: 20 })
            }
          }
          .width('100%')
          .justifyContent(FlexAlign.Center)
          .alignItems(HorizontalAlign.Center)
        }
        .width('100%')
        .padding({ bottom: 20 })
      }
      .layoutWeight(1)
      .scrollBar(BarState.Off)
      .edgeEffect(EdgeEffect.Spring)

      // è®¾ç½®å¼¹çª—
      if (this.showSettings) {
        Stack() {
          Column()
            .backgroundColor('rgba(0,0,0,0.5)')
            .width('100%')
            .height('100%')
            .onClick(() => this.showSettings = false)
          
          Column() {
            Text('è®¾ç½®')
              .fontSize(18)
              .fontWeight(FontWeight.Bold)
              .margin({ bottom: 16 })
            
            Row() {
              Text('å¼•å¯¼è¯­éŸ³')
                .fontSize(16)
                .fontColor('#333')
              Toggle({ type: ToggleType.Switch, isOn: true })
                .margin({ left: 16 })
            }
            .width('100%')
            .justifyContent(FlexAlign.SpaceBetween)
            .margin({ bottom: 12 })
            
            Row() {
              Text('èƒŒæ™¯éŸ³ä¹')
                .fontSize(16)
                .fontColor('#333')
              Toggle({ type: ToggleType.Switch, isOn: false })
                .margin({ left: 16 })
            }
            .width('100%')
            .justifyContent(FlexAlign.SpaceBetween)
            .margin({ bottom: 12 })
            
            Row() {
              Text('æŒ¯åŠ¨æé†’')
                .fontSize(16)
                .fontColor('#333')
              Toggle({ type: ToggleType.Switch, isOn: true })
                .margin({ left: 16 })
            }
            .width('100%')
            .justifyContent(FlexAlign.SpaceBetween)
            .margin({ bottom: 20 })
            
            Button('ç¡®å®š')
              .fontColor('#fff')
              .backgroundColor('#1976D2')
              .borderRadius(12)
              .width('100%')
              .onClick(() => this.showSettings = false)
          }
          .width('80%')
          .backgroundColor('#fff')
          .borderRadius(16)
          .padding(24)
          .alignSelf(ItemAlign.Center)
        }
        .width('100%')
        .height('100%')
        .position({ x: 0, y: 0 })
      }
    }
    .width('100%')
    .height('100%')
    .backgroundColor('#F8F9FB')
  }
} 