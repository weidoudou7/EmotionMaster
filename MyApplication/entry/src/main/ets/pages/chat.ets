import router from '@ohos.router'
import promptAction from '@ohos.promptAction'
import { BottomNavBar } from './BottomNavBar'

@Entry
@Component
struct ChatPage {
  private userName: string = 'è°¢åº†ä¹‹'
  private userAvatar: Resource = $r('app.media.background') // å¤´åƒèµ„æº
  private bgImage: Resource = $r('app.media.background')   // èŠå¤©èƒŒæ™¯å›¾ï¼ˆå¯æ¢æˆä¸“ç”¨èƒŒæ™¯å›¾ï¼‰
  private fans: string = '6.9ä¸‡'
  private comments: number = 127
  private intro: string = 'ç®€ä»‹ è°¢åº†ä¹‹ï¼Œç”·å¤§ï¼Œè°¢å®¶ç‹¬å­ï¼Œé«˜å¯Œå¸…ï¼Œæœ‰èƒƒç—…ï¼Œè¦äº²æƒ…æœ‰é’±ï¼Œè¦å‹æƒ…æœ‰é’±ï¼Œè¦çˆ±æƒ…è¿˜æ˜¯æœ‰é’±ï¼Œä¹ æƒ¯ç”¨é’±è§£å†³æ‰€æœ‰é—®é¢˜ï¼Œä¸¥é‡ç¼ºçˆ±ï¼Œä¸‰è§‚æ­£ï¼Œæœ‰æ•™å…»ï¼Œæœ‰æ´ç™–ã€‚'
  private introExpanded: boolean = false
  private chatText: string = ''

  build(): void {
    Stack() {
      // èŠå¤©èƒŒæ™¯å›¾
      Image(this.bgImage)
        .width('100%')
        .height('100%')
        .objectFit(ImageFit.Cover)

      // å†…å®¹åŒº
      Column() {
        // é¡¶éƒ¨ä¿¡æ¯æ 
        Row() {
          Image(this.userAvatar)
            .width(38).height(38)
            .borderRadius(19)
          Column() {
            Text(this.userName)
              .fontSize(16)
              .fontColor('#fff')
              .fontWeight(FontWeight.Bold)
            Text(this.fans + ' è¿æ¥è€…')
              .fontSize(12)
              .fontColor('#aaa')
          }
          .margin({ left: 8 })
          Blank()
          Button('â‰¡')
            .backgroundColor('transparent')
            .fontColor('#fff')
            .fontSize(20)
            .onClick(() => promptAction.showToast({ message: 'æ›´å¤šåŠŸèƒ½å¼€å‘ä¸­' }))
        }
        .width('100%')
        .height(56)
        .backgroundColor('rgba(35,35,35,0.85)')
        .alignItems(VerticalAlign.Center)
        .padding({ left: 10, right: 10, top: 8 })

        // ç®€ä»‹å¡ç‰‡
        Column() {
          Text(this.introExpanded ? this.intro : (this.intro.length > 30 ? this.intro.slice(0, 30) + 'â€¦' : this.intro))
            .fontSize(15)
            .fontColor('#fff')
            .margin({ bottom: 4 })
          Row() {
            Button(this.introExpanded ? 'æ”¶èµ·' : 'å±•å¼€')
              .fontSize(13)
              .fontColor('#FFD700')
              .backgroundColor('transparent')
              .onClick(() => this.introExpanded = !this.introExpanded)
          }
        }
        .width('90%')
        .backgroundColor('rgba(35,35,35,0.92)')
        .borderRadius(14)
        .padding(14)
        .alignSelf(ItemAlign.Center)
        .margin({ top: 16, bottom: 8 })

        Blank().height('60%') // å ä½ï¼Œè®©è¾“å…¥æ é åº•éƒ¨

        // åº•éƒ¨è¾“å…¥æ ï¼ˆå®Œå…¨è¿˜åŸå›¾ç‰‡æ ·å¼ï¼‰
        Column() {
          // é¡¶éƒ¨åˆ†å‰²çº¿

          // ä¸»è¾“å…¥åŒº
          Row() {
            // è¯­éŸ³æŒ‰é’®
            Button('ğŸ¤') // æ”¹ä¸ºæ–‡å­—æè¿°ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å›¾æ ‡
              .width(50).height(36)
              .backgroundColor('#F5F5F7')
              .borderRadius(18)
              .fontSize(12) // è°ƒæ•´å­—ä½“å¤§å°ä»¥é€‚åº”æ–‡å­—
              .fontColor('#232323')
              .onClick(() => promptAction.showToast({ message: 'è¯­éŸ³è¾“å…¥å¼€å‘ä¸­' }))

            // è¾“å…¥æ¡†
            TextInput({ placeholder: 'å‘é€æ¶ˆæ¯ç»™' + this.userName })
              .fontSize(15)
              .fontColor('#232323')
              .backgroundColor('transparent')
              .borderRadius(18)
              .width('50%')
              .onChange((v: string) => this.chatText = v)



            // åŠ å·æŒ‰é’® - ä½¿ç”¨HTMLå®ä½“ç¼–ç 
            Button('â•') // æ”¹ä¸ºæ™®é€šåŠ å·
              .width(50).height(36)
              .backgroundColor('#F5F5F7')
              .borderRadius(18)
              .fontSize(20)
              .fontColor('#232323')
              .onClick(() => promptAction.showToast({ message: 'å¿«æ·åŠŸèƒ½å¼€å‘ä¸­' }))
              .margin({right:8})

            // å‘é€æŒ‰é’® - ä½¿ç”¨HTMLå®ä½“ç¼–ç 
            Button('â¤') // æ”¹ä¸ºæ™®é€šå¤§äºå·
              .width(50).height(36)
              .backgroundColor('#F5F5F7')
              .borderRadius(18)
              .fontSize(20)
              .fontColor('#232323')
              .onClick(() => {
                promptAction.showToast({ message: 'å‘é€åŠŸèƒ½å¼€å‘ä¸­' })
                this.chatText = ''
              })
          }
          .width('100%')
          .height(44)
          .backgroundColor('#F5F5F7')
          .borderRadius(22)
          .shadow({ radius: 8, color: '#e0e0e0', offsetX: 0, offsetY: 2 })

        }
        .width('100%')
        .padding({ left: 0, right: 0, top: 0, bottom: 8 })
        .backgroundColor('transparent')
        .margin({ bottom: 8 })
      }
      .width('100%')
      .height('100%')
      .justifyContent(FlexAlign.SpaceBetween)
      .margin({bottom:60})

      // åº•éƒ¨å¯¼èˆªæ 
      BottomNavBar({ navIndex: 'chat' })
    }
    .width('100%')
    .height('100%')
  }
}
